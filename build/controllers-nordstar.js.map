{"version":3,"sources":["controllers-nordstar.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","MealServicePickerController","increase","vm","canPlus","updateState","onIncrease","decrease","canMinus","onDecrease","count","limit","mealItem","restrictSelect","this","angular","component","templateUrl","controller","controllerAs","bindings","locked","2","restrictSelectMealController","$scope","watchman","restrcitMealSelect","subgroup","_","forEach","$watchCollection","bind","service","newServiceValue","itemsByPassengerSegments","passenger","id","totalSelectedMealCountForPassenger","reduce","result","subgroupItem","sum","alreadySelectedCount","directive","restrict","scope","restrictCount","orderInfo","mealMenu","bindToController","3","./components/meal-service-picker/meal-service-picker","./directives/restrictSelectMeal"],"mappings":"CAAA,WAAY,QAASA,GAAEC,EAAEC,EAAEC,GAAG,QAASC,GAAEC,EAAEC,GAAG,IAAIJ,EAAEG,GAAG,CAAC,IAAIJ,EAAEI,GAAG,CAAC,GAAIE,GAAE,kBAAmBC,UAASA,OAAQ,KAAIF,GAAGC,EAAE,MAAOA,GAAEF,GAAE,EAAI,IAAGI,EAAE,MAAOA,GAAEJ,GAAE,EAAI,IAAIK,GAAE,GAAIC,OAAM,uBAAuBN,EAAE,IAAK,MAAMK,GAAEE,KAAK,mBAAmBF,EAAE,GAAIG,GAAEX,EAAEG,IAAIS,WAAYb,GAAEI,GAAG,GAAGU,KAAKF,EAAEC,QAAQ,SAASd,GAAG,GAAIE,GAAED,EAAEI,GAAG,GAAGL,EAAG,OAAOI,GAAEF,GAAGF,IAAIa,EAAEA,EAAEC,QAAQd,EAAEC,EAAEC,EAAEC,GAAG,MAAOD,GAAEG,GAAGS,QAAQ,IAAI,GAAIL,GAAE,kBAAmBD,UAASA,QAAQH,EAAE,EAAEA,EAAEF,EAAEa,OAAOX,IAAID,EAAED,EAAEE,GAAI,OAAOD,GAAE,MAAOJ,OAAOiB,GAAG,SAAST,EAAQU,EAAOJ,GACxe,YAeA,SAASK,KAQL,QAASC,KACDC,EAAGC,UACHC,IACAF,EAAGG,cAIX,QAASC,KACDJ,EAAGK,WACHH,IACAF,EAAGM,cAIX,QAASJ,KACAF,EAAGO,QACJP,EAAGO,MAAQ,GAGfP,EAAGC,QAAWD,EAAGO,MAAQP,EAAGQ,QAAUR,EAAGS,SAASC,eAClDV,EAAGK,SAAYL,EAAGO,MAAQ,EA3B9B,GAAIP,GAAKW,IAETX,GAAGD,SAAWA,EACdC,EAAGI,SAAWA,EAEdF,IApBJU,QAAQf,OAAO,OAAOgB,UAAU,qBAC5BC,YAAa,0DACbC,YAAajB,GACbkB,aAAc,KACdC,UACIV,MAAO,IACPE,SAAU,IACVD,MAAO,IACPL,WAAY,IACZG,WAAY,IACZY,OAAQ,YAoCVC,GAAG,SAAShC,EAAQU,EAAOJ,GACjC,YAqBA,SAAS2B,GAA6BC,EAAQC,GA0B1C,QAASC,GAAmBC,GACpBA,GACAC,EAAEC,QAAQF,EAAU,SAAUA,GAC1BC,EAAEC,QAAQF,EAAU,SAAUf,GAC1BA,EAASC,gBAAiB,MA7B1C,GAAIV,GAAKW,IAETU,GAAOM,iBAAiBf,QAAQgB,KAAKjB,KAAM,WACvC,MAAOX,GAAG6B,UACX,GAAO,SAAUC,GAChBL,EAAEC,QAAQI,EAAgBC,yBAA0B,SAAUC,EAAWC,GACrER,EAAEC,QAAQM,EAAW,SAAUR,GAC3B,GAAIU,GAAqCT,EAAEU,OAAOX,EAAU,SAAUY,EAAQC,GAE1E,MAAOD,GAASX,EAAEU,OAAOE,EAAc,SAAUC,EAAK7B,GAClD,MAAIA,GAAS8B,qBACFD,EAAM7B,EAAS8B,qBAEfD,GAEZ,IACJ,EAECJ,IAAsC,GACtCX,EAAmBC,SAxCvCZ,QAAQf,OAAO,OAAO2C,UAAU,qBAAsB,WAClD,OACIC,SAAU,IACVzB,aAAc,KACd0B,OACIC,cAAiB,IACjBC,UAAa,IACbC,SAAY,IACZhB,QAAW,KAEfiB,kBAAkB,EAClB/B,WACI,kCAKZH,QAAQf,OAAO,OAAOkB,WAAW,gCAAiC,SAAU,WAAYK,SAuClF2B,GAAG,SAAS5D,EAAQU,EAAOJ,GACjC,YACAN,GAAQ,mCACRA,EAAQ,0DAEL6D,uDAAuD,EAAEC,kCAAkC,SAAS","file":"controllers-nordstar.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\nangular.module('app').component('mealServicePicker', {\n    templateUrl: 'components/meal-service-picker/meal-service-picker.html',\n    controller: [MealServicePickerController],\n    controllerAs: 'vm',\n    bindings: {\n        count: '=',\n        mealItem: '=',\n        limit: '=',\n        onIncrease: '&',\n        onDecrease: '&',\n        locked: '='\n    }\n});\n\nfunction MealServicePickerController() {\n    var vm = this;\n\n    vm.increase = increase;\n    vm.decrease = decrease;\n\n    updateState();\n\n    function increase() {\n        if (vm.canPlus) {\n            updateState();\n            vm.onIncrease();\n        }\n    }\n\n    function decrease() {\n        if (vm.canMinus) {\n            updateState();\n            vm.onDecrease();\n        }\n    }\n\n    function updateState() {\n        if (!vm.count) {\n            vm.count = 0;\n        }\n\n        vm.canPlus = (vm.count < vm.limit && !vm.mealItem.restrictSelect);\n        vm.canMinus = (vm.count > 0);\n    }\n}\n\n},{}],2:[function(require,module,exports){\n\"use strict\";\nangular.module('app').directive('restrictMealSelect', function () {\n    return {\n        restrict: 'A',\n        controllerAs: 'vm',\n        scope: {\n            'restrictCount': '=',\n            'orderInfo': '=',\n            'mealMenu': '=',\n            'service': '='\n        },\n        bindToController: true,\n        controller:\n            'restrictSelectMealController'\n    }\n});\n\n\nangular.module('app').controller('restrictSelectMealController', ['$scope', 'watchman', restrictSelectMealController]);\n\n\nfunction restrictSelectMealController($scope, watchman) {\n    var vm = this;\n\n    $scope.$watchCollection(angular.bind(this, function () {\n        return vm.service;\n    }, true), function (newServiceValue) {\n        _.forEach(newServiceValue.itemsByPassengerSegments, function (passenger, id) {\n            _.forEach(passenger, function (subgroup) {\n                var totalSelectedMealCountForPassenger = _.reduce(subgroup, function (result, subgroupItem) {\n\n                    return result + _.reduce(subgroupItem, function (sum, mealItem) {\n                        if (mealItem.alreadySelectedCount) {\n                            return sum + mealItem.alreadySelectedCount;\n                        } else {\n                            return sum;\n                        }\n                    }, 0);\n                }, 0);\n\n                if (totalSelectedMealCountForPassenger >= 2) {\n                    restrcitMealSelect(subgroup);\n                }\n            })\n        });\n    });\n\n    function restrcitMealSelect(subgroup) {\n        if (subgroup) {\n            _.forEach(subgroup, function (subgroup) {\n                _.forEach(subgroup, function (mealItem) {\n                    mealItem.restrictSelect = true;\n                })\n            })\n        }\n    }\n}\n},{}],3:[function(require,module,exports){\n\"use strict\";\nrequire('./directives/restrictSelectMeal');\nrequire('./components/meal-service-picker/meal-service-picker');\n\n},{\"./components/meal-service-picker/meal-service-picker\":1,\"./directives/restrictSelectMeal\":2}]},{},[3]);\n"]}